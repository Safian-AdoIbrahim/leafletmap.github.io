function adjustLayerbyZoom(a){if(a>10){if(!NGRAdmin2){map.addLayer(nigeriaAdminLayer2);for(var e=0;e<NGRLabels.length;e++)NGRLabels[e].addTo(map);NGRAdmin2=!0}}else{map.removeLayer(nigeriaAdminLayer2);for(var e=0;e<NGRLabels.length;e++)map.removeLayer(NGRLabels[e]);NGRAdmin2=!1}}function triggerUiUpdate(){state=$("#state_scope").val(),lga=$("#lga_scope").val(),bank=$("#bank_scope").val(),console.log("All Seleceted: ",state+"  "+lga+"  "+bank);var a=buildQuery(state,lga,bank);getData(a),console.log("QUERY:  ",a),prefecture_select=$("#state_scope").val()}function buildQuery(a,e,o){var t=!1;return query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM datapro_visualization",a.length>0||e.length>0||o.length>0?(query=query.concat(" WHERE"),a.length>0&&(query=query.concat(" state = '".concat(a.concat("'"))),t=!0),e.length>0&&(query=query.concat(t?" AND lga = '".concat(e.concat("'")):" lga = '".concat(e.concat("'"))),t=!0),o.length>0&&(query=query.concat(t?" AND bank = '".concat(o.concat("'")):" bank = '".concat(o.concat("'"))),t=!0)):query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM datapro_visualization",query}function addDataToMap(a){null!=dataLayer&&map.removeLayer(dataLayer),null!=markerGroup&&map.removeLayer(markerGroup);var e=L.icon({iconUrl:"image/user1.jpg",iconSize:[20,20],iconAnchor:[25,25]});$("#projectCount").text(a.features.length),markerGroup=L.markerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0}),dataLayer=L.geoJson(a,{pointToLayer:function(a,o){var t=L.marker(o,{icon:e});return t},onEachFeature:function(a,e){a.properties&&a.properties.cartodb_id&&e.on("click",function(){displayInfo(a)})}}),markerGroup.addLayer(dataLayer),map.addLayer(markerGroup)}function addAdminLayersToMap(a){var e={admin0:{clickable:!0,color:"#B81609",fillColor:"#ffffff",weight:2,opacity:1,fillOpacity:.05},admin2:{clickable:!0,color:"#412406",fillColor:"#80FFFFFF",weight:1.5,opacity:.5,fillOpacity:.05},region:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2,opacity:.7,fillOpacity:.05},prefecture:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2.5,opacity:.7,fillOpacity:.05}};stateSelect=$("#state_scope").val(),lgaSelect=$("#lga_scope").val(),console.log("State_LGA: ",stateSelect+"  "+lgaSelect),nigeriaAdminLayer0=L.geoJson(a.nigeriaAdmin0,{style:e.admin0}).addTo(map),nigeriaAdminLayer2=L.geoJson(a.nigeriaAdmin2,{style:e.region,onEachFeature:function(a,e){var o=L.divIcon({className:"labelLga-icon",html:a.properties.LGAName});NGRLabels.push(L.marker(e.getBounds().getCenter(),{icon:o}))}}),null!=state_layer&&map.removeLayer(state_layer),state_layer=L.geoJson(a.nigeriaAdmin1,{filter:function(a){return a.properties.StateName===stateSelect},style:e.region}).addTo(map),map.fitBounds(state_layer),null!=lga_layer&&map.removeLayer(lga_layer),lga_layer=L.geoJson(a.nigeriaAdmin2,{filter:function(a){return a.properties.LGAName===lgaSelect},style:e.region}).addTo(map),map.fitBounds(lga_layer),console.log("Zoom Level ",map.getZoom())}function displayInfo(a){var e=buildPopupContent(a);$("#infoContent").html(e)}function normalizeName(a){return a=a.replace("_"," ").replace("of_"," of "),a=a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}function buildPopupContent(a){for(var e="",o=["bank","customer_name","risk_score","lga","ref_no","address","nearest_bustop","type_of_structure","landmark","name_of_landmark","customer_status","client","contact_name","convinction","visiting_officer_name","verification_status"],t=0;t<o.length;t++)e=e.concat("<p><strong>"+normalizeName(o[t])+": </strong>"+a.properties[o[t]]+"</p>");return e}function showLoader(){$(".fa-spinner").addClass("fa-spin"),$(".fa-spinner").show()}function hideLoader(){$(".fa-spinner").removeClass("fa-spin"),$(".fa-spinner").hide()}function getData(a){showLoader(),$.post(a,function(a){hideLoader(),addDataToMap(a),console.log("Data-Geo::  ",a)}).fail(function(){console.log("error!")})}function getAdminLayers(){var a={};$.get("resources/NGR_Admin0.json",function(e){a.nigeriaAdmin0=e,$.get("resources/NGR_Admin1.json",function(e){a.nigeriaAdmin1=e,$.get("resources/NGR_Admin2.json",function(e){a.nigeriaAdmin2=e,addAdminLayersToMap(a)}).fail(function(){logError(null)})}).fail(function(){logError(null)})}).fail(function(){logError(null)})}function logError(){console.log("error!")}var d,m,y,date,type="",distance,state,twokm,threekm,fourkm,region="",prefecture="",prefecture_select="",sub_prefecture="",geoData=null,dataLayer=null,markerGroup=null,nigeriaAdminLayer0,nigeriaAdminLayer1,nigeriaAdminLayer2,country_layer=null,state_layer=null,lga_layer=null,ward_layer=null,bufferLayer=null,substance_layer=null,NGRLabels=[],within,within_fc,buffered=null,NGRAdmin2=!1,googleSat=L.tileLayer("https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),googleStreets=L.tileLayer("https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),osm=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20}),mapbox=L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicy1jaGFuZCIsImEiOiJjaXdmcmtnc2QwMDBhMnltczBldmc1MHZuIn0.eIdXZvG0VOOcZhhoHpUQYA"),map=L.map("map",{center:[10,8],zoom:6,zoomControl:!1,layers:[osm],minZoom:6}),baseMaps={"Google Satelite":googleSat,OSM:osm,"Google Street":googleStreets,"Map Box":mapbox};map.on("zoomend",function(){adjustLayerbyZoom(map.getZoom())}),new L.Control.Zoom({position:"topright"}).addTo(map),L.control.layers(baseMaps).addTo(map),L.control.scale({position:"bottomright",maxWidth:100,metric:!0,updateWhenIdle:!0}).addTo(map),getAdminLayers(),hideLoader();
//# sourceMappingURL=main.min.js.map
