function customerName(){customer_name=$("#customer_name").val(),console.log("Customer Name: ",customer_name),customer_name.length>2&&triggerUiUpdate()}function triggerUiUpdate(){state=$("#state_scope").val(),lga=$("#lga_scope").val(),bank=$("#bank_scope").val(),customer_name=$("#customer_name").val(),console.log("All Seleceted: ",state+"  "+customer_name+"  "+bank);var e=buildQuery(state,customer_name,bank);getData(e),console.log("QUERY:  ",e),prefecture_select=$("#state_scope").val()}function buildQuery(e,o,a){var t=!1;return query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM datapro_visualization",e.length>0||o>2||a.length>0?(query=query.concat(" WHERE"),e.length>0&&(query=query.concat(" state = '".concat(e.concat("'"))),t=!0),o.length>2&&(query=query.concat(t?" AND customer_name LIKE '%25".concat(o.concat("%25'")):" customer_name LIKE '%25".concat(o.concat("%25'"))),t=!0),a.length>0&&(query=query.concat(t?" AND bank = '".concat(a.concat("'")):" bank = '".concat(a.concat("'"))),t=!0)):query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM datapro_visualization",query}function addDataToMap(e){null!=dataLayer&&map.removeLayer(dataLayer),null!=markerGroup&&map.removeLayer(markerGroup);var o=L.icon({iconUrl:"image/user1.jpg",iconSize:[20,20],iconAnchor:[25,25]});$("#projectCount").text(e.features.length),markerGroup=L.markerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0}),dataLayer=L.geoJson(e,{pointToLayer:function(e,a){var t=L.marker(a,{icon:o});return t},onEachFeature:function(e,o){e.properties&&e.properties.cartodb_id&&o.on("click",function(){displayInfo(e)})}}),markerGroup.addLayer(dataLayer),map.addLayer(markerGroup)}function addAdminLayersToMap(e){var o={admin0:{clickable:!0,color:"#B81609",fillColor:"#ffffff",weight:2,opacity:1,fillOpacity:.05},admin2:{clickable:!0,color:"#412406",fillColor:"#80FFFFFF",weight:1.5,opacity:.5,fillOpacity:.05},region:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2,opacity:.7,fillOpacity:.05},prefecture:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2.5,opacity:.7,fillOpacity:.05}};stateSelect=$("#state_scope").val(),lgaSelect=$("#lga_scope").val(),console.log("State_LGA: ",stateSelect+"  "+lgaSelect),nigeriaAdminLayer0=L.geoJson(e.nigeriaAdmin0,{style:o.admin0}).addTo(map),nigeriaAdminLayer2=L.geoJson(e.nigeriaAdmin2,{style:o.region,onEachFeature:function(e,o){var a=L.divIcon({className:"labelLga-icon",html:e.properties.LGAName});NGRLabels.push(L.marker(o.getBounds().getCenter(),{icon:a}))}}),null!=state_layer&&map.removeLayer(state_layer),state_layer=L.geoJson(e.nigeriaAdmin1,{filter:function(e){return e.properties.StateName===stateSelect},style:o.region}).addTo(map),console.log(state_layer),map.fitBounds(state_layer.getBounds()),null!=lga_layer&&map.removeLayer(lga_layer),lga_layer=L.geoJson(e.nigeriaAdmin2,{filter:function(e){return e.properties.LGAName===lgaSelect},style:o.region}).addTo(map),map.fitBounds(lga_layer.getBounds()),console.log("Zoom Level ",map.getZoom())}function displayInfo(e){var o=buildPopupContent(e);$("#infoContent").html(o)}function normalizeName(e){return e=e.replace("_"," ").replace("of_"," of "),e=e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function buildPopupContent(e){for(var o="",a=["bank","customer_name","risk_score","lga","ref_no","address","nearest_bustop","type_of_structure","landmark","name_of_landmark","customer_status","client","contact_name","convinction","visiting_officer_name","verification_status"],t=0;t<a.length;t++)o=o.concat("<p><strong>"+normalizeName(a[t])+": </strong>"+e.properties[a[t]]+"</p>");return o}function showLoader(){$(".fa-spinner").addClass("fa-spin"),$(".fa-spinner").show()}function hideLoader(){$(".fa-spinner").removeClass("fa-spin"),$(".fa-spinner").hide()}function getData(e){showLoader(),$.post(e,function(e){hideLoader(),addDataToMap(e),console.log("Data-Geo::  ",e)}).fail(function(){console.log("error!")})}function getAdminLayers(){var e={};$.get("resources/NGR_Admin0.json",function(o){e.nigeriaAdmin0=o,$.get("resources/NGR_Admin1.json",function(o){e.nigeriaAdmin1=o,$.get("resources/NGR_Admin2.json",function(o){e.nigeriaAdmin2=o,addAdminLayersToMap(e)}).fail(function(){logError(null)})}).fail(function(){logError(null)})}).fail(function(){logError(null)})}function logError(){console.log("error!")}var d,m,y,date,type="",distance,state,twokm,threekm,fourkm,region="",prefecture="",prefecture_select="",sub_prefecture="",geoData=null,dataLayer=null,markerGroup=null,nigeriaAdminLayer0,nigeriaAdminLayer1,nigeriaAdminLayer2,country_layer=null,state_layer=null,lga_layer=null,ward_layer=null,bufferLayer=null,substance_layer=null,NGRLabels=[],within,within_fc,buffered=null,NGRAdmin2=!1,googleSat=L.tileLayer("https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),googleStreets=L.tileLayer("https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),osm=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20}),mapbox=L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicy1jaGFuZCIsImEiOiJjaXdmcmtnc2QwMDBhMnltczBldmc1MHZuIn0.eIdXZvG0VOOcZhhoHpUQYA"),map=L.map("map",{center:[10,8],zoom:6,zoomControl:!1,layers:[osm],minZoom:6,maxZoom:22}),baseMaps={"Google Satelite":googleSat,OSM:osm,"Google Street":googleStreets,"Map Box":mapbox};map.on("zoomend",function(){}),new L.Control.Zoom({position:"bottomright"}).addTo(map),L.control.layers(baseMaps).addTo(map),getAdminLayers(),hideLoader();
//# sourceMappingURL=main.min.js.map
