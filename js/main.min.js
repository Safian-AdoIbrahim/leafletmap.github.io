function adjustLayerbyZoom(a){if(a>10){if(!NGRAdmin2){map.addLayer(nigeriaAdminLayer2);for(var o=0;o<NGRLabels.length;o++)NGRLabels[o].addTo(map);NGRAdmin2=!0}}else{map.removeLayer(nigeriaAdminLayer2);for(var o=0;o<NGRLabels.length;o++)map.removeLayer(NGRLabels[o]);NGRAdmin2=!1}}function triggerUiUpdate(){societe=$("#societe_scope").val(),region=$("#state_scope").val(),prefecture=$("#lga_scope").val(),substance=$("#substance_type").val(),console.log("All Seleceted: ",societe+"  "+region+"  "+prefecture+"  "+substance+"  "+date);var a=buildQuery(region,prefecture,sub_prefecture,date);getData(a),prefecture_select=$("#state_scope").val()}function buildQuery(a,o,e){var i=!1;return query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM mine_guinea",console.log("Date in Query: ",date),o.length>0||e.length>0||societe.length>0||substance.length>0?(query=query.concat(" WHERE"),o.length>0&&(query=query.concat(" region = '".concat(o.concat("'"))),i=!0),e.length>0&&(query=query.concat(i?" AND prefecture = '".concat(e.concat("'")):" prefecture = '".concat(e.concat("'"))),i=!0),societe.length>0&&(query=query.concat(i?" AND societe = '".concat(societe.concat("'")):" societe = '".concat(societe.concat("'"))),i=!0),substance.length>0&&(query=query.concat(i?" AND substance = '".concat(substance.concat("'")):" substance = '".concat(substance.concat("'"))),i=!0)):query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM mine_guinea",query}function addDataToMap(a){null!=dataLayer&&map.removeLayer(dataLayer),null!=markerGroup&&map.removeLayer(markerGroup);var o=L.icon({iconUrl:"image/dolerite.jpg",iconSize:[20,20],iconAnchor:[25,25]});$("#projectCount").text(a.features.length),markerGroup=L.markerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0}),dataLayer=L.geoJson(a,{pointToLayer:function(a,e){var i=L.marker(e,{icon:o});return i},onEachFeature:function(a,o){a.properties&&a.properties.cartodb_id&&o.on("click",function(){displayInfo(a)})}}),markerGroup.addLayer(dataLayer),map.fitBounds(dataLayer),map.addLayer(markerGroup)}function addAdminLayersToMap(a){var o={admin0:{clickable:!0,color:"#B81609",fillColor:"#ffffff",weight:2,opacity:1,fillOpacity:.05},admin2:{clickable:!0,color:"#412406",fillColor:"#80FFFFFF",weight:1.5,opacity:.5,fillOpacity:.05},region:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2,opacity:.7,fillOpacity:.05},prefecture:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2.5,opacity:.7,fillOpacity:.05}};stateSelect=$("#state_scope").val(),lgaSelect=$("#lga_scope").val(),console.log("State_LGA: ",stateSelect+"  "+lgaSelect),nigeriaAdminLayer0=L.geoJson(a.nigeriaAdmin0,{style:o.admin0}).addTo(map),nigeriaAdminLayer2=L.geoJson(a.nigeriaAdmin2,{style:o.region,onEachFeature:function(a,o){var e=L.divIcon({className:"labelLga-icon",html:a.properties.LGAName});NGRLabels.push(L.marker(o.getBounds().getCenter(),{icon:e}))}}),null!=state_layer&&map.removeLayer(state_layer),state_layer=L.geoJson(a.nigeriaAdmin1,{filter:function(a){return a.properties.StateName===stateSelect},style:o.region}).addTo(map),map.fitBounds(state_layer),null!=lga_layer&&map.removeLayer(lga_layer),lga_layer=L.geoJson(a.nigeriaAdmin2,{filter:function(a){return a.properties.LGAName===lgaSelect},style:o.region}).addTo(map),map.fitBounds(lga_layer),console.log("Zoom Level ",map.getZoom())}function displayInfo(a){var o=buildPopupContent(a);$("#infoContent").html(o)}function normalizeName(a){return a=a.replace("_"," ").replace("of_"," of "),a=a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})}function buildPopupContent(a){for(var o="",e=["date","region","prefecture","sous_prefecture","prenoms_et_nom","fonction","societe","prenom_directeur","prenom_nom_directeur","sexe_directeur","adresse_email","numero_telephone"],i=0;i<e.length;i++)o=o.concat("<p><strong>"+normalizeName(e[i])+": </strong>"+a.properties[e[i]]+"</p>");return o}function showLoader(){$(".fa-spinner").addClass("fa-spin"),$(".fa-spinner").show()}function hideLoader(){$(".fa-spinner").removeClass("fa-spin"),$(".fa-spinner").hide()}function getData(a){showLoader(),$.post(a,function(a){hideLoader(),addDataToMap(a),console.log("Data-Geo::  ",a)}).fail(function(){console.log("error!")})}function getAdminLayers(){var a={};$.get("resources/NGR_Admin0.json",function(o){a.nigeriaAdmin0=o,addAdminLayersToMap(a)}).fail(function(){logError(null)}),$.get("resources/NGR_Admin1.json",function(o){a.nigeriaAdmin1=o,addAdminLayersToMap(a)}).fail(function(){logError(null)}),$.get("resources/NGR_Admin2.json",function(o){a.nigeriaAdmin2=o,addAdminLayersToMap(a)}).fail(function(){logError(null)})}function logError(){console.log("error!")}var d,m,y,date,type="",distance,twokm,threekm,fourkm,region="",prefecture="",prefecture_select="",sub_prefecture="",geoData=null,dataLayer=null,markerGroup=null,nigeriaAdminLayer0,nigeriaAdminLayer1,nigeriaAdminLayer2,country_layer=null,state_layer=null,lga_layer=null,ward_layer=null,bufferLayer=null,substance_layer=null,NGRLabels=[],within,within_fc,buffered=null,NGRAdmin2=!1,googleSat=L.tileLayer("https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),googleStreets=L.tileLayer("https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),osm=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18}),mapbox=L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicy1jaGFuZCIsImEiOiJjaXdmcmtnc2QwMDBhMnltczBldmc1MHZuIn0.eIdXZvG0VOOcZhhoHpUQYA"),map=L.map("map",{center:[10,8],zoom:6,animation:!0,zoomControl:!1,layers:[osm]});map.options.minZoom=5;var baseMaps={"Google Satelite":googleSat,OSM:osm,"Google Street":googleStreets,"Map Box":mapbox};map.on("zoomend",function(){adjustLayerbyZoom(map.getZoom())}),new L.Control.Zoom({position:"topright"}).addTo(map),L.control.layers(baseMaps).addTo(map),L.control.scale({position:"bottomright",maxWidth:100,metric:!0,updateWhenIdle:!0}).addTo(map),getAdminLayers(),hideLoader();
//# sourceMappingURL=main.min.js.map
