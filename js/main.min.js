function adjustLayerbyZoom(e){if(e>11){if(!NGRAdmin2){map.addLayer(nigeriaAdminLayer2);for(var a=0;a<NGRLabels.length;a++)NGRLabels[a].addTo(map);NGRAdmin2=!0}}else{map.removeLayer(nigeriaAdminLayer2);for(var a=0;a<NGRLabels.length;a++)map.removeLayer(NGRLabels[a]);NGRAdmin2=!1}}function triggerUiUpdate(){societe=$("#societe_scope").val(),region=$("#state_scope").val(),prefecture=$("#lga_scope").val(),substance=$("#substance_type").val(),console.log("All Seleceted: ",societe+"  "+region+"  "+prefecture+"  "+substance+"  "+date);var e=buildQuery(region,prefecture,sub_prefecture,date);getData(e),prefecture_select=$("#state_scope").val()}function buildQuery(e,a,o){var r=!1;return query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM mine_guinea",console.log("Date in Query: ",date),a.length>0||o.length>0||societe.length>0||substance.length>0?(query=query.concat(" WHERE"),a.length>0&&(query=query.concat(" region = '".concat(a.concat("'"))),r=!0),o.length>0&&(query=query.concat(r?" AND prefecture = '".concat(o.concat("'")):" prefecture = '".concat(o.concat("'"))),r=!0),societe.length>0&&(query=query.concat(r?" AND societe = '".concat(societe.concat("'")):" societe = '".concat(societe.concat("'"))),r=!0),substance.length>0&&(query=query.concat(r?" AND substance = '".concat(substance.concat("'")):" substance = '".concat(substance.concat("'"))),r=!0)):query="https://femtope.cartodb.com/api/v2/sql?format=GeoJSON&q=SELECT * FROM mine_guinea",query}function addDataToMap(e){null!=dataLayer&&map.removeLayer(dataLayer),null!=markerGroup&&map.removeLayer(markerGroup);var a=L.icon({iconUrl:"image/dolerite.jpg",iconSize:[20,20],iconAnchor:[25,25]});$("#projectCount").text(e.features.length),markerGroup=L.markerClusterGroup({showCoverageOnHover:!1,zoomToBoundsOnClick:!0,removeOutsideVisibleBounds:!0}),dataLayer=L.geoJson(e,{pointToLayer:function(e,o){var r=L.marker(o,{icon:a});return r},onEachFeature:function(e,a){e.properties&&e.properties.cartodb_id&&a.on("click",function(){displayInfo(e)})}}),markerGroup.addLayer(dataLayer),map.fitBounds(dataLayer),map.addLayer(markerGroup)}function addAdminLayersToMap(e){var a={admin0:{clickable:!0,color:"#B81609",fillColor:"#ffffff",weight:2,opacity:1,fillOpacity:.05},admin2:{clickable:!0,color:"#412406",fillColor:"#80FFFFFF",weight:1.5,opacity:.5,fillOpacity:.05},region:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2,opacity:.7,fillOpacity:.05},prefecture:{clickable:!0,color:"#e2095c",fillColor:"#80FFFFFF",weight:2.5,opacity:.7,fillOpacity:.05}};stateSelect=$("#state_scope").val(),lgaSelect=$("#lga_scope").val(),nigeriaAdminLayer0=L.geoJson(e.nigeriaAdmin0,{style:a.admin0}).addTo(map),nigeriaAdminLayer2=L.geoJson(e.nigeriaAdmin2,{style:a.region,onEachFeature:function(e,a){var o=L.divIcon({className:"labelLga-icon",html:e.properties.LGAName});NGRLabels.push(L.marker(a.getBounds().getCenter(),{icon:o}))}}),null!=state_layer&&map.removeLayer(state_layer),state_layer=L.geoJson(e.nigeriaAdmin1,{filter:function(e){return e.properties.StateName===stateSelect},style:a.region}).addTo(map),map.fitBounds(state_layer),null!=lga_layer&&map.removeLayer(lga_layer),lga_layer=L.geoJson(e.nigeriaAdmin2,{filter:function(e){return e.properties.LGAName===lgaSelect},style:a.region}).addTo(map),map.fitBounds(lga_layer),console.log("Zoom Level ",map.getZoom())}function displayInfo(e){var a=buildPopupContent(e);$("#infoContent").html(a)}function normalizeName(e){return e=e.replace("_"," ").replace("of_"," of "),e=e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function buildPopupContent(e){for(var a="",o=["date","region","prefecture","sous_prefecture","prenoms_et_nom","fonction","societe","prenom_directeur","prenom_nom_directeur","sexe_directeur","adresse_email","numero_telephone"],r=0;r<o.length;r++)a=a.concat("<p><strong>"+normalizeName(o[r])+": </strong>"+e.properties[o[r]]+"</p>");return a}function showLoader(){$(".fa-spinner").addClass("fa-spin"),$(".fa-spinner").show()}function hideLoader(){$(".fa-spinner").removeClass("fa-spin"),$(".fa-spinner").hide()}function getData(e){showLoader(),$.post(e,function(e){hideLoader(),addDataToMap(e),console.log("Data-Geo::  ",e)}).fail(function(){console.log("error!")})}function getAdminLayers(){var e={};$.get("resources/NGR_Admin0.json",function(a){e.nigeriaAdmin0=a,addAdminLayersToMap(e)}).fail(function(){logError(null)}),$.get("resources/NGR_Admin1.json",function(a){e.nigeriaAdmin1=a,addAdminLayersToMap(e)}).fail(function(){logError(null)}),$.get("resources/NGR_Admin2.json",function(a){e.nigeriaAdmin2=a,addAdminLayersToMap(e)}).fail(function(){logError(null)})}function logError(){console.log("error!")}var d,m,y,date,type="",distance,twokm,threekm,fourkm,region="",prefecture="",prefecture_select="",sub_prefecture="",geoData=null,dataLayer=null,markerGroup=null,nigeriaAdminLayer0,nigeriaAdminLayer1,nigeriaAdminLayer2,country_layer=null,state_layer=null,lga_layer=null,ward_layer=null,bufferLayer=null,substance_layer=null,NGRLabels=[],within,within_fc,buffered=null,NGRAdmin2=!1,googleSat=L.tileLayer("https://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),googleStreets=L.tileLayer("https://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),osm=L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18}),mapbox=L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v9/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1Ijoicy1jaGFuZCIsImEiOiJjaXdmcmtnc2QwMDBhMnltczBldmc1MHZuIn0.eIdXZvG0VOOcZhhoHpUQYA"),map=L.map("map",{center:[10,8],zoom:6,animation:!0,zoomControl:!1,layers:[osm]});map.options.minZoom=5;var baseMaps={"Google Satelite":googleSat,OSM:osm,"Google Street":googleStreets,"Map Box":mapbox};map.on("zoomend",function(){adjustLayerbyZoom(map.getZoom())}),new L.Control.Zoom({position:"topright"}).addTo(map),L.control.layers(baseMaps).addTo(map),L.control.scale({position:"bottomright",maxWidth:100,metric:!0,updateWhenIdle:!0}).addTo(map),getAdminLayers(),hideLoader();
//# sourceMappingURL=main.min.js.map
